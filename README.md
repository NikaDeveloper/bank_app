# Widget Project

## Описание

IT-отдел крупного банка делает новую фичу для личного кабинета клиента. 
Это виджет, который показывает несколько последних успешных банковских операций клиента.
## Установка

1.  Клонируйте репозиторий:
    ```bash
    [git clone] (-> git@github.com:NikaDeveloper/bank_app.git <-)
    ```

2.  Перейдите в директорию проекта:
    ```bash
    cd bank_app
    ```

3.  Установите зависимости с помощью Poetry:
    ```bash
    poetry install
    ```
    *(Убедитесь, что у вас установлен Poetry)*


# Зависимости 

### Установленные зависимости можно посмотреть в pyproject.toml.

# Основные модули и функции

### Модуль processing.py

* process_bank_search(data: list[dict], search: str) -> list[dict]
Возвращает операции, в описании которых содержится строка поиска (поиск нечувствителен к регистру).

* process_bank_operations(data: list[dict], categories: list) -> dict
Подсчитывает количество операций в каждой из указанных категорий (регистронезависимо).
Возвращает словарь вида {категория: количество}.

### Модуль main.py

#### Основная логика запуска программы:

* Пользователь выбирает источник данных (JSON, CSV, XLSX).

* Загружаются данные.

* Выполняется фильтрация по статусу операции (EXECUTED, CANCELED, PENDING).

* По желанию пользователя операции сортируются по дате (возрастание/убывание).

* Фильтруются операции по валюте (рубли).

* По желанию можно фильтровать операции по ключевому слову в описании.

* Выводится итоговый список операций с замаскированными счетами и картами.

### Работа с файлами CSV и Excel

* read_finance_operations_csv(path_file: str) -> list[dict] — чтение CSV файла, возвращает список транзакций.

* read_finance_operations_excel(path_file: str) -> list[dict] — чтение XLSX файла, возвращает список транзакций.

  * read_finance_operations_json(path_file: str) -> list[dict] — чтение JSON файла, возвращает список транзакций.

## Тестирование

Для запуска тестов выполните:
``` pytest ```

### Основные тесты:

#### Тесты модуля processing.py
* Проверяют корректность функций фильтрации, сортировки и поиска по описанию, а также подсчет операций по категориям.

* Используют параметризацию, фикстуры и проверяют граничные случаи.

#### Тесты чтения JSON, CSV и Excel (в test_read_transaction.py)
* Используют unittest.mock для подмены вызовов pandas.read_csv и pandas.read_excel,

* проверяют корректное чтение данных, обработку ошибок (файл не найден, исключения), и возврат пустых списков при ошибках.

#### Пример работы с фильтрацией и поиском
``` 
filtered = process_bank_search(data, "кофе")
summary = process_bank_operations(filtered, ["кофе", "книги"])
print(summary)  # {'кофе': 3, 'книги': 1} 
```

#### Маскирование счетов и карт
##### Используется в выводе для безопасности отображаемых данных — счета и номера карт показываются частично.
